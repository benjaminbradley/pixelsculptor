(this.webpackJsonppixelsculptor=this.webpackJsonppixelsculptor||[]).push([[0],{15:function(e,t,c){},16:function(e,t,c){},18:function(e,t,c){"use strict";c.r(t);var n,a=c(0),r=c.n(a),o=c(9),l=c.n(o),i=(c(15),c(2)),s=(c(16),c(7)),u=c(3),d=c(1),j={CUSTOM_PALETTE:"cp",SCULPT_PATH:"s",PALETTE_TYPE:"pt",PALETTE_NAME:"p",DEFAULT_COLOR:"d"},b={GRADIENT:"g",CYCLE:"c",MONOCHROME:"m"},f=(n={},Object(u.a)(n,j.PALETTE_TYPE,b.GRADIENT),Object(u.a)(n,j.PALETTE_NAME,"gs"),Object(u.a)(n,j.DEFAULT_COLOR,"#ddd"),n),O=Object(a.createContext)(),p=1;function h(){if(0===window.location.hash.length)return{};var e={};return window.location.hash.substring(1).split("&").forEach((function(t){var c=t.split("="),n=Object(i.a)(c,2),a=n[0],r=n[1];r.length&&(e[a]=decodeURIComponent(r))})),e}function E(e,t){var c=h();c[e]=t;var n=Object.entries(c).map((function(e){var t=Object(i.a)(e,2),c=t[0],n=t[1];return"".concat(c,"=").concat(encodeURIComponent(n))})).join("&");window.location.hash=n}function T(e,t){return{type:p,key:e,value:t}}var v=function(e,t){switch(t.type){case p:return Object(s.a)(Object(s.a)({},e),{},Object(u.a)({},t.key,t.value));default:return e}};function m(e){var t=Object(a.useReducer)(v,f),c=Object(i.a)(t,2),n={config:c[0],dispatch:c[1]};return Object(d.jsx)(O.Provider,Object(s.a)({value:n},e))}function C(){return Object(a.useContext)(O)}var g=c(4),x={custom:[],a:["#b2b2b2","#50394c","#f4e1d2","#ffef96"],b:["#80ced6","#d5f4e6","#fefbd8","#618685"],c:["#034f84","#92a8d1","#f7cac9","#f7786b"],d:["#4040a1","#36486b","#618685","#fefbd8"],e:["#6b5b95","#878f99","#a2b9bc","#b2ad7f"],f:["#622569","#b8a9c9","#d6d4e0","#5b9aa0"],g:["#c83349","#e06377","#eeac99","#f9d5e5"],h:["#ff7b25","#d64161","#6b5b95","#feb236"],i:["#d96459","#f2ae72","#588c7e","#f2e394"],j:["#b2ad7f","#878f99","#a2b9bc","#6b5b95"],bw:["#fff","#000"]},_={custom:{},a:{0:"#fefbd8",15:"#4040a1"},b:{0:"#f9d5e5",15:"#c83349"},c:{0:"#80ced6",6:"#622569",15:"#000"},d:{0:"#f00",5:"#0f0",10:"#00f",15:"#f00"},e:{0:"#0f0",5:"#00f",10:"#f00",15:"#0f0"},f:{0:"#00f",5:"#f00",10:"#0f0",15:"#00f"},gs:{0:"#fff",15:"#000"}};function A(e,t){if(t===b.CYCLE)return e.map((function(e){return e.colorCode})).join(",");if(t===b.GRADIENT){var c=L(e);return Object.entries(c).map((function(e){var t=Object(i.a)(e,2),c=t[0],n=t[1];return"".concat(c,":").concat(n)})).join(",")}return console.log("ERROR: Unknown CustomPalette type: '".concat(t,"'")),null}function P(e,t){if(!e)return[];if(t===b.CYCLE)return e.split(",").map((function(e){return{colorCode:e}}));if(t===b.GRADIENT){var c=[];e.split(",").forEach((function(e){var t=e.split(":"),n=Object(i.a)(t,2),a=n[0],r=n[1];c[a]={colorCode:r}}));for(var n=0;n<c.length;n++)c[n]||(c[n]={colorCode:""});return c}return console.log("ERROR: Unknown CustomPalette type: '".concat(t,"'")),null}function L(e){for(var t={},c=0;c<e.length;c++)e[c]&&"colorCode"in e[c]&&e[c].colorCode&&(t[c]=e[c].colorCode);return t}var y={};var N=function(){var e=document.createElement("canvas");e.width=e.height=1;var t=e.getContext("2d");return function(e,t){return function(c){return c in y||(y[c]=e.call(t,c)),y[c]}}((function(e){t.clearRect(0,0,1,1),t.fillStyle="#000",t.fillStyle=e;var c=t.fillStyle;return t.fillStyle="#fff",t.fillStyle=e,c!==t.fillStyle?null:(t.fillRect(0,0,1,1),Object(g.a)(t.getImageData(0,0,1,1).data))}))}();function S(e,t,c){return e<t?(t-e)*c+e:e-(e-t)*c}function R(e){for(var t=Object.keys(e).map((function(e){return parseInt(e)})).sort((function(e,t){return e<t?-1:e===t?0:1})),c=0,n=1,a={};n<t.length;){var r=t[c],o=t[n],l=N(e[r]);l||(l=[0,0,0]);var i=N(e[o]);i||(i=[0,0,0]);for(var s=r;s<=o;s++){for(var u=(s-r)/(o-r),d=[],j=0;j<3;j++)d[j]=Math.round(S(l[j],i[j],u));var b="#".concat(d[0].toString(16).padStart(2,"0"),d[1].toString(16).padStart(2,"0"),d[2].toString(16).padStart(2,"0"));a[s]=b}c++,n++}return a}var k=function e(t){var c=t.loadSculptPath,n=t.onUpdate,r=t.depth,o=t.orientation,l=C().config,s=Object(a.useState)(!1),u=Object(i.a)(s,2),f=u[0],O=u[1],p=Object(a.useState)(null),h=Object(i.a)(p,2),E=h[0],T=h[1],v=Object(a.useState)(null),m=Object(i.a)(v,2),g=m[0],A=m[1],y=0,N=1,S=2,k=Object(a.useRef)(y);Object(a.useEffect)((function(){-1===c&&f&&(T(-1),A(-1),O(!1)),"[object Array]"===Object.prototype.toString.call(c)&&k.current===y&&(k.current=N,O(!0),c.length>0&&(T(c[0]),c.length>1&&A(c[1])),k.current=S)}),[c]);var U=Object(a.useRef)([0]),M=Object(a.useRef)([]),w=Object(a.useRef)([]);function D(){U.current=f?[1].concat(M.current,w.current):[0],"[object Array]"===Object.prototype.toString.call(c)&&k.current===N||n(U.current)}Object(a.useEffect)((function(){D()}),[f,M,w,n]);var Y=["btap",o];0===r&&Y.push("base");var G=function(e,t){switch(e[j.PALETTE_TYPE]){case b.MONOCHROME:return e[j.DEFAULT_COLOR];case b.CYCLE:var c,n=e[j.PALETTE_NAME];if("custom"===n)c=P(e[j.CUSTOM_PALETTE],b.CYCLE).map((function(e){return e.colorCode}));else{if(!n||!Object.keys(x).includes(n))return console.log("ERROR: Unknown Cycle Palette name '".concat(n,"'")),null;c=x[n]}return c[t%c.length];case b.GRADIENT:var a,r=e[j.PALETTE_NAME];if("custom"===r)a=L(P(e[j.CUSTOM_PALETTE],b.GRADIENT));else{if(!r||!Object.keys(_).includes(r))return console.log("ERROR: Unknown Gradient Palette name '".concat(r,"'")),null;a=_[r]}var o=R(a);return Object.keys(o).map((function(e){return parseInt(e)})).includes(t)?o[t]:e[j.DEFAULT_COLOR];default:return null}}(l,r);return f?Object(d.jsxs)("div",{className:Y.join(" "),"data-depth":r,style:G?{backgroundColor:G}:null,children:[Object(d.jsx)(e,{depth:r+1,orientation:"h"===o?"v":"h",onUpdate:function(e){M.current=e,D()},loadSculptPath:E}),Object(d.jsx)(e,{depth:r+1,orientation:"h"===o?"v":"h",onUpdate:function(e){w.current=e,D()},loadSculptPath:g})]}):Object(d.jsx)("div",{className:Y.join(" "),onClick:function(){return O(!0)},"data-depth":r,style:G?{backgroundColor:G}:null})},U=c(10),M=c.p+"static/media/ftadd.17ed1b53.svg",w=c.p+"static/media/ftedit-remove.6b6c8a76.svg",D=c.p+"static/media/ftpencil.8ab7c672.svg",Y=c.p+"static/media/ftinscol.0fd71b40.svg",G=c.p+"static/media/ftbrackets.2ca1db48.svg";var I=function(e){var t=e.type,c=C(),n=c.config,r=c.dispatch,o=Object(a.useState)(P("",t)),l=Object(i.a)(o,2),s=l[0],u=l[1],f=Object(a.useState)({}),O=Object(i.a)(f,2),p=O[0],h=O[1],v=Object(a.useState)(!1),m=Object(i.a)(v,2),x=m[0],_=m[1],y=Object(a.useState)(!1),N=Object(i.a)(y,2),S=N[0],k=N[1],I=Object(a.useState)(""),F=Object(i.a)(I,2),H=F[0],B=F[1],z=Object(a.useRef)();function Z(e,t){s[e].colorCode=t,u(Object(g.a)(s))}Object(a.useEffect)((function(){u(P(n[j.CUSTOM_PALETTE],t))}),[n,t]),Object(a.useEffect)((function(){var e=A(s,t);if(e){if(t===b.GRADIENT){var c=L(s);h(R(c))}e!==n[j.CUSTOM_PALETTE]&&(r(T(j.CUSTOM_PALETTE,e)),E(j.CUSTOM_PALETTE,e))}}),[s,t,r,n]);var J={colorCode:""};return Object(d.jsxs)("div",{className:"customPalette",children:[t===b.GRADIENT&&Object.entries(p).map((function(e){var t=Object(i.a)(e,2),c=t[0],n=t[1];return Object(d.jsx)("div",{className:"colorsample gradient",style:{backgroundColor:n}},"palette_gradient_CUSTOM_".concat(c,"_").concat(n.replace(/[^0-9a-zA-Z]/,"")))})),t===b.CYCLE&&s.map((function(e,t){return Object(d.jsx)("div",{className:"colorsample",style:{backgroundColor:e.colorCode}},"palette_cycle_CUSTOM_".concat(t))})),Object(d.jsx)("span",{children:"custom"}),Object(d.jsx)("button",{onClick:function(){return _(!0)},className:"edit",title:"Edit custom palette",children:Object(d.jsx)("img",{src:D,alt:"Edit custom palette"})}),x&&Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{className:"custom-palette-creator-backdrop"}),Object(d.jsx)("div",{className:"custom-palette-creator-container",children:Object(d.jsxs)("div",{className:"custom-palette-creator",children:[Object(d.jsx)("button",{className:"close",onClick:function(){return _(!1)},title:"Close custom palette editor",children:Object(d.jsx)("img",{src:G,alt:"Close custom palette editor"})}),Object(d.jsx)("h2",{children:"Custom Palette Editor"}),Object(d.jsxs)("div",{className:"palette-entries",children:[s.map((function(e,t){return Object(d.jsxs)("div",{className:"palette-entry",children:[Object(d.jsxs)("div",{className:"pe-row",children:[t,Object(d.jsx)("div",{className:"colorsample",style:{backgroundColor:e.colorCode?e.colorCode:(c=t,c in p?p[c]:null)}})]}),Object(d.jsx)("div",{className:"pe-row",children:Object(d.jsx)("input",{type:"text",value:e.colorCode,onChange:function(e){return Z(t,e.target.value)},placeholder:"#RRGGBB",title:"Enter an HTML color name or code in #RGB or #RRGGBB hexadecimal format"})}),Object(d.jsxs)("div",{className:"pe-row",children:[Object(d.jsx)("button",{onClick:function(){return function(e){s.splice(e,0,J),u(Object(g.a)(s))}(t)},className:"add-before",title:"Add palette entry before this one",children:Object(d.jsx)("img",{src:Y,alt:"Add palette entry before this"})}),Object(d.jsx)("button",{onClick:function(){return function(e){s.splice(e,1),u(Object(g.a)(s))}(t)},className:"remove",title:"Remove this palette entry",children:Object(d.jsx)("img",{src:w,alt:"Remove this palette entry"})}),Object(d.jsx)("button",{onClick:function(){return c=e.colorCode,n=t,B(c),z.current=n,void k(!0);var c,n},className:"edit",title:"Open color picker",children:Object(d.jsx)("img",{src:D,alt:"Open color picker"})})]})]},"custpalcr_idx_".concat(t));var c})),Object(d.jsxs)("div",{className:"palette-entry",children:[Object(d.jsx)("button",{onClick:function(){s.push(J),u(Object(g.a)(s))},className:"add-entry",title:"Add palette entry",children:Object(d.jsx)("img",{src:M,alt:"Add palette entry to end"})}),!s.length&&Object(d.jsx)("span",{children:" \u21d0 click to add to the palette"})]})]}),S&&Object(d.jsx)(U.a,{color:H,onChange:function(e){k(!1),Z(z.current,e)}})]})})]})]})};var F=function(e){var t,c=e.doSculpt,n=C(),a=n.config,r=n.dispatch;function o(e,t){switch(e){case j.DEFAULT_COLOR:document.documentElement.style.setProperty("--default-color",t);break;case j.PALETTE_TYPE:if(a[j.CUSTOM_PALETTE]&&[b.CYCLE,b.GRADIENT].includes(a[j.PALETTE_TYPE])&&[b.CYCLE,b.GRADIENT].includes(t)&&a[j.PALETTE_TYPE]!==t){var c=A(P(a[j.CUSTOM_PALETTE],a[j.PALETTE_TYPE]),t);r(T(j.CUSTOM_PALETTE,c)),E(j.CUSTOM_PALETTE,c)}break;case j.PALETTE_NAME:case j.GRADIENT_NAME:break;default:console.log("Unknown settings key: '".concat(e,"'"))}r(T(e,t)),E(e,t)}return Object(d.jsxs)("div",{children:[Object(d.jsx)("h1",{children:"Make it yours"}),Object(d.jsxs)("div",{id:"settings",children:[Object(d.jsxs)("div",{className:"setting",children:[Object(d.jsx)("label",{children:"Palette type:"}),Object(d.jsx)("div",{id:"palette-type-options",children:Object.entries({"Monochrome (use default color)":b.MONOCHROME,"Repeating cycle":b.CYCLE,Gradient:b.GRADIENT}).map((function(e){var t=Object(i.a)(e,2),c=t[0],n=t[1];return Object(d.jsxs)("div",{children:[Object(d.jsx)("input",{type:"radio",name:"palette_type",value:n,id:"palette_type_".concat(n),checked:a[j.PALETTE_TYPE]===n,onChange:function(e){return o(j.PALETTE_TYPE,e.target.value)}}),Object(d.jsx)("label",{htmlFor:"palette_type_".concat(n),children:c}),b.CYCLE===n&&a[j.PALETTE_TYPE]===n?Object(d.jsxs)("div",{id:"palette-options",children:[Object(d.jsx)("span",{className:"help",children:"Palette colors will cycle and repeat with depth."}),Object.entries(x).map((function(e){var t=Object(i.a)(e,2),c=t[0],r=t[1];return Object(d.jsxs)("div",{children:[Object(d.jsx)("input",{type:"radio",name:"palette",value:c,id:"palette_cycle_".concat(c),checked:a[j.PALETTE_NAME]===c,onChange:function(e){return o(j.PALETTE_NAME,e.target.value)}}),Object(d.jsxs)("label",{htmlFor:"palette_cycle_".concat(c),children:["custom"===c&&Object(d.jsx)(I,{type:n}),r.map((function(e){return Object(d.jsx)("div",{className:"colorsample",style:{backgroundColor:e}},"palette_cycle_".concat(c,"_").concat(e.replace(/[^0-9a-zA-Z]/,"")))}))]})]},"palette_cycle_".concat(c))}))]}):null,b.GRADIENT===n&&a[j.PALETTE_TYPE]===n?Object(d.jsxs)("div",{id:"gradient-options",children:[Object(d.jsx)("span",{className:"help",children:"Palette colors transition between two or more colors."}),Object.entries(_).map((function(e){var t=Object(i.a)(e,2),c=t[0],r=t[1];return Object(d.jsxs)("div",{children:[Object(d.jsx)("input",{type:"radio",name:"palette",value:c,id:"palette_gradient_".concat(c),checked:a[j.PALETTE_NAME]===c,onChange:function(e){return o(j.PALETTE_NAME,e.target.value)}}),Object(d.jsxs)("label",{htmlFor:"palette_gradient_".concat(c),children:["custom"===c&&Object(d.jsx)(I,{type:n}),Object.entries(R(r)).map((function(e){var t=Object(i.a)(e,2),n=t[0],a=t[1];return Object(d.jsx)("div",{className:"colorsample gradient",style:{backgroundColor:a}},"palette_gradient_".concat(c,"_").concat(n,"_").concat(a.replace(/[^0-9a-zA-Z]/,"")))}))]})]},"palette_gradient_".concat(c))}))]}):null]},"palette_type_".concat(n))}))})]}),Object(d.jsxs)("div",{className:"setting",children:[Object(d.jsx)("label",{htmlFor:"default-color",children:"Default color:"}),Object(d.jsx)("input",{id:"default-color",type:"text",value:(t=j.DEFAULT_COLOR,Object.keys(a).includes(t)?a[t]:""),onChange:function(e){return o(j.DEFAULT_COLOR,e.target.value)}}),Object(d.jsx)("div",{id:"default-color-sample",className:"colorsample"}),Object(d.jsx)("br",{}),Object(d.jsx)("span",{className:"help",children:"Can be any valid HTML color name, or a code in #rgb or #rrggbb format."})]}),Object(d.jsx)("button",{onClick:c,children:"Let's Sculpt!"}),Object(d.jsx)("a",{target:"_blank",rel:"noreferrer",className:"big button",href:"https://github.com/benjaminbradley/pixelsculptor#readme",children:"About"})]})]})};function H(e,t){if(0===e.length)return[[0,0],[]];for(var c=[],n=0;n<2&&e.length>0;){var a=e.shift();if(n++,a){var r,o=H(e,t+1),l=Object(i.a)(o,2);r=l[0],e=l[1],c.push(r)}else c.push(a)}return[c,e]}var B=function(){var e=C(),t=e.config,c=e.dispatch,n=3,r=1,o=Object(a.useState)(n),l=Object(i.a)(o,2),s=l[0],u=l[1],b=Object(a.useState)(null),f=Object(i.a)(b,2),O=f[0],p=f[1];function v(){u(r)}return Object(a.useEffect)((function(){var e=h();Object.entries(e).forEach((function(e){var t=Object(i.a)(e,2),n=t[0],a=t[1];Object.values(j).includes(n)&&c(T(n,a))})),e[j.SCULPT_PATH]&&t[j.SCULPT_PATH]!==e[j.SCULPT_PATH]&&(t[j.SCULPT_PATH]=e[j.SCULPT_PATH])}),[window.location.hash]),Object(a.useEffect)((function(){if(t[j.SCULPT_PATH]){var e=H(function(e){for(var t=atob(e),c=[];t.length>0;){var n=t.substring(0,1);t=t.slice(1);for(var a=n.charCodeAt(0),r=7;r>=0;r--){var o=(a&Math.pow(2,r))>0?1:0;c.push(o)}}for(;0===c[c.length-1];)c.pop();return c}(t[j.SCULPT_PATH]),0),c=Object(i.a)(e,1)[0];c.length&&(console.log("starting replay"),v(),p(c[0]),console.log("window.performance.memory =",window.performance.memory))}}),[t[j.SCULPT_PATH]]),Object(d.jsx)("div",{className:"App",children:s===n?Object(d.jsx)(F,{doSculpt:v}):Object(d.jsxs)("div",{children:[Object(d.jsxs)("div",{className:"canvasButtons",children:[Object(d.jsx)("button",{onClick:function(){u(n)},children:"Palette"}),Object(d.jsx)("button",{onClick:function(){p(-1),setTimeout((function(){return p(null)}),10)},children:"Reset"})]}),Object(d.jsx)(k,{depth:0,orientation:"v",onUpdate:function(e){var t=function(e){for(var t="";e.length>0;){for(var c=e.splice(0,8),n=0,a=0;a<8&&a<c.length;a++){n+=c[a]*Math.pow(2,7-a)}t+=String.fromCharCode(n)}return btoa(t)}(e);E(j.SCULPT_PATH,t)},loadSculptPath:O})]})})},z=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,19)).then((function(t){var c=t.getCLS,n=t.getFID,a=t.getFCP,r=t.getLCP,o=t.getTTFB;c(e),n(e),a(e),r(e),o(e)}))};l.a.render(Object(d.jsx)(r.a.StrictMode,{children:Object(d.jsx)(m,{children:Object(d.jsx)(B,{})})}),document.getElementById("root")),z()}},[[18,1,2]]]);
//# sourceMappingURL=main.36ce1ba8.chunk.js.map